<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rituel 22h ðŸŒ™</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
  // Configuration Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyBPNfMyhIOTWyGG-ZB5pOTr-y3TA0J3B28",
    authDomain: "mon-projet062.firebaseapp.com",
    databaseURL: "https://mon-projet062-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "mon-projet062",
    storageBucket: "mon-projet062.appspot.com",
    messagingSenderId: "1054174163421",
    appId: "1:1054174163421:web:50817b3c930a5eb55ac634",
    measurementId: "G-8L7E9C9ZY8"
  };

  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();
</script>

<style>
/* ðŸŒ™ Style global */
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap');

body {
  font-family: 'Montserrat', sans-serif;
  margin:0;
  padding:20px;
  background: linear-gradient(160deg, #1b0f2e, #3a0d46);
  color:#fff;
  transition: background 0.5s;
}

h1,h2 { text-align:center; margin-bottom:10px; }
p.intro { text-align:center; font-size:16px; margin-bottom:20px; opacity:0.9; }

.button {
  padding:10px;
  border:none;
  border-radius:12px;
  font-weight:600;
  font-size:14px;
  cursor:pointer;
  transition: all 0.3s ease;
}
.validate-btn { background: #9b5de5; color:white; width:100%; margin-bottom:20px; box-shadow:0 5px 15px rgba(0,0,0,0.3);}
.validate-btn:hover { transform:translateY(-3px); box-shadow:0 8px 20px rgba(0,0,0,0.4);}
.mini-btn { background:#f15bb5; color:white; }
.mini-btn:hover { transform:scale(1.05); }

.container { display:flex; flex-direction:column; gap:20px; margin-top:20px; }
@media(min-width:700px){ .container { flex-direction:row; justify-content:space-between; } }

.card {
  background: rgba(255,255,255,0.05);
  padding:20px;
  border-radius:16px;
  flex:1;
  min-width:280px;
  backdrop-filter: blur(10px);
  display:flex;
  flex-direction:column;
  gap:16px;
  transition: transform 0.3s, box-shadow 0.3s;
}
.card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.4); }

textarea { 
  width:100%; min-height:50px; padding:12px; border-radius:12px; border:none; background: rgba(255,255,255,0.1); color:white; font-size:14px;
  transition: background 0.3s, transform 0.2s;
}
textarea:focus { background: rgba(255,255,255,0.2); transform: scale(1.02); outline:none; }

.display-question {
  background: rgba(255,255,255,0.15); padding:10px 14px; border-radius:10px; font-style:italic; transition: background 0.3s;
}
.display-question:hover { background: rgba(255,255,255,0.25); }

#timer {
  text-align:center;
  margin-bottom:20px;
  font-weight:bold;
  font-size:18px;
  color:#fbb1c1;
}

.done-icon { font-size:24px; color:#4caf50; display:none; margin-left:10px; vertical-align:middle; }

.notification {
  position: fixed;
  top:20px;
  left:50%;
  transform: translateX(-50%);
  background: #4caf50;
  color:white;
  padding:12px 24px;
  border-radius:14px;
  font-weight:bold;
  box-shadow:0 5px 20px rgba(0,0,0,0.3);
  opacity:0;
  animation: fadein 0.5s forwards, fadeout 0.5s 2.5s forwards;
  z-index:9999;
}
@keyframes fadein { from {opacity:0;} to {opacity:1;} }
@keyframes fadeout { from {opacity:1;} to {opacity:0;} }
</style>
</head>
<body>

<h1>ðŸŒ™ Rituel 22h</h1>
<p class="intro">Prenez 10 minutes pour poser votre journÃ©e et partager vos Ã©motions. Tout disparaÃ®t automatiquement Ã  minuit.</p>

<button class="button validate-btn" onclick="validateRules()">âœ… Jâ€™accepte les rÃ¨gles</button>

<div id="ritual" class="hidden">
<div id="timer"></div>
<div class="container">
  <!-- Rayan -->
  <div class="card">
    <h2>Rayan <span id="doneRayan" class="done-icon">âœ…</span></h2>
    <div class="answer-section">
      <p>Question du jour</p>
      <div id="displayRayanQuestion" class="display-question">...</div>
      <div style="display:flex; gap:6px;">
        <textarea id="rayanQuestion" placeholder="RÃ©pond iciâ€¦"></textarea>
        <button class="button mini-btn" onclick="newQuestion()">ðŸŽ²</button>
      </div>
    </div>
    <div class="answer-section">
      <p>Journal de la journÃ©e</p>
      <textarea id="rayan1" placeholder="Aujourdâ€™hui jâ€™ai gardÃ© pour moiâ€¦"></textarea>
      <textarea id="rayan2" placeholder="Aujourdâ€™hui jâ€™ai Ã©tÃ© fier(e) deâ€¦"></textarea>
      <textarea id="rayan3" placeholder="Aujourdâ€™hui jâ€™aurais aimÃ© te direâ€¦"></textarea>
      <textarea id="rayan4" placeholder="Un truc qui mâ€™a saoulÃ© / blessÃ©â€¦"></textarea>
      <textarea id="rayan5" placeholder="Aujourdâ€™hui jâ€™ai manquÃ© deâ€¦"></textarea>
      <button class="button mini-btn" onclick="done('Rayan')">ðŸ–¤ TerminÃ©</button>
    </div>
  </div>

  <!-- Israh -->
  <div class="card">
    <h2>Israh <span id="doneIsrah" class="done-icon">âœ…</span></h2>
    <div class="answer-section">
      <p>Question du jour</p>
      <div id="displayIsrahQuestion" class="display-question">...</div>
      <div style="display:flex; gap:6px;">
        <textarea id="israhQuestion" placeholder="RÃ©pond iciâ€¦"></textarea>
        <button class="button mini-btn" onclick="newQuestion()">ðŸŽ²</button>
      </div>
    </div>
    <div class="answer-section">
      <p>Journal de la journÃ©e</p>
      <textarea id="israh1" placeholder="Aujourdâ€™hui jâ€™ai gardÃ© pour moiâ€¦"></textarea>
      <textarea id="israh2" placeholder="Aujourdâ€™hui jâ€™ai Ã©tÃ© fier(e) deâ€¦"></textarea>
      <textarea id="israh3" placeholder="Aujourdâ€™hui jâ€™aurais aimÃ© te direâ€¦"></textarea>
      <textarea id="israh4" placeholder="Un truc qui mâ€™a saoulÃ© / blessÃ©â€¦"></textarea>
      <textarea id="israh5" placeholder="Aujourdâ€™hui jâ€™ai manquÃ© deâ€¦"></textarea>
      <button class="button mini-btn" onclick="done('Israh')">ðŸ–¤ TerminÃ©</button>
    </div>
  </div>
</div>
</div>

<script>
// ðŸ”¹ Questions
const questions = [
"Le moment le plus drÃ´le de ta journÃ©e ? ðŸ˜‚",
"Si ta journÃ©e Ã©tait un film, son titre ? ðŸŽ¬",
"RÃ©sume ta journÃ©e en 3 mots absurdes ðŸ˜œ",
"Un dÃ©tail nul mais marrant avec le recul ðŸ¤ª",
"Un truc que tu as aimÃ© chez lâ€™autre aujourd'hui ðŸ’–",
"Si ta journÃ©e Ã©tait un animal, lequel ? ðŸ¶ðŸ±",
"Un moment oÃ¹ tu t'es senti fier(e) ðŸ’ª",
"Un petit dÃ©fi ridicule que tu as rÃ©ussi ðŸ˜",
"Un moment qui tâ€™a fait sourire pour rien ðŸ˜„",
"Si tu pouvais rejouer 1 moment, lequel ? âœ¨"
];

function newQuestion(){
const q = questions[Math.floor(Math.random()*questions.length)];
document.getElementById("displayRayanQuestion").innerText = q;
document.getElementById("displayIsrahQuestion").innerText = q;
}

// ðŸ”¹ Firebase
function saveDataFirebase() {
const data = {
rayan: [
document.getElementById("rayan1").value,
document.getElementById("rayan2").value,
document.getElementById("rayan3").value,
document.getElementById("rayan4").value,
document.getElementById("rayan5").value,
document.getElementById("displayRayanQuestion").innerText,
document.getElementById("rayanQuestion").value
],
israh: [
document.getElementById("israh1").value,
document.getElementById("israh2").value,
document.getElementById("israh3").value,
document.getElementById("israh4").value,
document.getElementById("israh5").value,
document.getElementById("displayIsrahQuestion").innerText,
document.getElementById("israhQuestion").value
]
};
database.ref('rituel22h').set(data);
}

function loadDataFirebase() {
database.ref('rituel22h').once('value').then(snapshot => {
const data = snapshot.val();
if (data) {
["rayan","israh"].forEach(user=>{
for(let i=1;i<=5;i++){
document.getElementById(user+i).value = data[user][i-1] || "";
}
});
document.getElementById("displayRayanQuestion").innerText = data.rayan[5] || "...";
document.getElementById("displayIsrahQuestion").innerText = data.israh[5] || "...";
document.getElementById("rayanQuestion").value = data.rayan[6] || "";
document.getElementById("israhQuestion").value = data.israh[6] || "";
document.getElementById("ritual").classList.remove("hidden"); // montre le rituel si donnÃ©es existantes
document.querySelector(".validate-btn").style.display="none";
}
});
}

// ðŸ”¹ TerminÃ©
function done(prenom){
if(prenom==="Rayan") {
document.getElementById("doneRayan").style.display="inline";
showNotification("Rayan a terminÃ© âœ…");
} else {
document.getElementById("doneIsrah").style.display="inline";
showNotification("Israh a terminÃ© âœ…");
}
saveDataFirebase();
}

// ðŸ”¹ Notification
function showNotification(msg){
let notif = document.createElement("div");
notif.classList.add("notification");
notif.innerText = msg;
document.body.appendChild(notif);
setTimeout(()=> notif.remove(),3000);
}

// ðŸ”¹ Sauvegarde Ã  chaque frappe
document.querySelectorAll("textarea").forEach(el=>{
el.addEventListener("input", saveDataFirebase);
});

// ðŸ”¹ Timer et suppression Ã  minuit
function updateTimer(){
const now = new Date();
const midnight = new Date();
midnight.setHours(24,0,0,0);
const diff = midnight - now;
if(diff<=0){ 
  database.ref('rituel22h').remove();
  location.reload();
  return;
}
const h = Math.floor(diff/1000/60/60);
const m = Math.floor((diff/1000/60)%60);
const s = Math.floor((diff/1000)%60);
document.getElementById("timer").innerText = `Temps restant pour rÃ©pondre : ${h}h ${m}m ${s}s`;
}
setInterval(updateTimer,1000);

// ðŸ”¹ Notifications 21h50 et 22h00
function checkNotifications(){
const now = new Date();
if(now.getHours()===21 && now.getMinutes()===50){ showNotification("ðŸŒ™ Le rituel 22h commence dans 10 minutes !"); }
if(now.getHours()===22 && now.getMinutes()===0){ showNotification("ðŸŒ™ Le rituel 22h commence !"); }
}
setInterval(checkNotifications,60000);

// ðŸ”¹ Validation rÃ¨gles
function validateRules(){
document.querySelector(".validate-btn").style.display="none";
document.getElementById("ritual").classList.remove("hidden");
newQuestion();
}

// ðŸ”¹ Charger donnÃ©es Firebase au dÃ©marrage
window.addEventListener('load', () => {
  loadDataFirebase();
});
</script>
</body>
</html>
