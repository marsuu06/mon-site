<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>L'Harmonie ðŸŒ™</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap');
        :root { --accent: #9b5de5; --bg: #090511; --glass: rgba(255, 255, 255, 0.05); --pink: #f178ff; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; margin: 0; background: var(--bg); color: #fff; background: radial-gradient(circle at top, #1a0b2e, var(--bg)); min-height: 100vh; overflow-x: hidden; }
        .card { background: var(--glass); border-radius: 30px; padding: 25px; border: 1px solid rgba(255,255,255,0.08); backdrop-filter: blur(10px); margin: 15px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 10px; max-width: 900px; margin: auto; }
        #pixel-canvas { display: grid; grid-template-columns: repeat(8, 1fr); gap: 4px; max-width: 280px; margin: 0 auto; }
        .pixel { aspect-ratio: 1; background: rgba(255,255,255,0.05); border-radius: 4px; cursor: pointer; }
        .mood-emoji { font-size: 1.6rem; cursor: pointer; opacity: 0.3; transition: 0.3s; padding: 5px; }
        .mood-emoji.active { opacity: 1; transform: scale(1.2); filter: drop-shadow(0 0 8px var(--accent)); }
        textarea { width: 100%; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 15px; color: #fff; padding: 12px; font-family: inherit; resize: none; box-sizing: border-box; margin-bottom: 8px; }
        .finish-btn { width: 100%; padding: 16px; border-radius: 18px; border: none; background: linear-gradient(45deg, var(--accent), var(--pink)); color: white; font-weight: 700; cursor: pointer; }
        #secret-tap { position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; background: var(--accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; border: none; box-shadow: 0 0 20px var(--accent); z-index: 100; cursor: pointer; font-size: 1.5rem; }
    </style>
</head>
<body>
    <h1 style="text-align:center; margin-top:30px; font-weight: 800; letter-spacing: -1px;">L'Harmonie ðŸŒ™</h1>
    <div id="timer" style="text-align:center; color:var(--accent); font-size:0.8rem; margin-bottom:20px; opacity: 0.7;">Initialisation...</div>

    <div class="grid">
        <div class="card">
            <h3 style="margin-top:0">MÃ©tÃ©o du CÅ“ur</h3>
            <p style="font-size: 0.7rem; opacity: 0.5; margin-bottom: 5px;">RAYAN</p>
            <div id="mood-rayan"><span class="mood-emoji" onclick="setMood('rayan','ðŸ˜Š')">ðŸ˜Š</span><span class="mood-emoji" onclick="setMood('rayan','ðŸ˜´')">ðŸ˜´</span><span class="mood-emoji" onclick="setMood('rayan','ðŸ”¥')">ðŸ”¥</span><span class="mood-emoji" onclick="setMood('rayan','ðŸ¥º')">ðŸ¥º</span></div>
            <p style="font-size: 0.7rem; opacity: 0.5; margin: 10px 0 5px 0;">ISRAH</p>
            <div id="mood-israh"><span class="mood-emoji" onclick="setMood('israh','ðŸ˜Š')">ðŸ˜Š</span><span class="mood-emoji" onclick="setMood('israh','ðŸ˜´')">ðŸ˜´</span><span class="mood-emoji" onclick="setMood('israh','ðŸ”¥')">ðŸ”¥</span><span class="mood-emoji" onclick="setMood('israh','ðŸ¥º')">ðŸ¥º</span></div>
        </div>
        <div class="card">
            <h3 style="margin-top:0">Le Jardin des Pixels</h3>
            <div id="pixel-canvas"></div>
            <button onclick="db.child('pix').remove()" style="background:none; border:none; color:gray; cursor:pointer; font-size:0.6rem; margin-top:10px; width:100%;">RÃ©initialiser le jardin</button>
        </div>
    </div>

    <div class="grid">
        <div class="card">
            <h3>Journal de Rayan</h3>
            <textarea id="r1" placeholder="Une pensÃ©e pour elle..."></textarea>
            <button class="finish-btn" onclick="complete('Rayan')">Sceller mon cÅ“ur ðŸ–¤</button>
        </div>
        <div class="card">
            <h3>Journal d'Israh</h3>
            <textarea id="i1" placeholder="Une pensÃ©e pour lui..."></textarea>
            <button class="finish-btn" style="background:var(--pink)" onclick="complete('Israh')">Sceller mon cÅ“ur ðŸ–¤</button>
        </div>
    </div>

    <button id="secret-tap" onclick="sendLove()">ðŸ’–</button>

    <script>
        const config = {
            apiKey: "AIzaSyBPNfMyhIOTWyGG-ZB5pOTr-y3TA0J3B28",
            authDomain: "mon-projet062.firebaseapp.com",
            databaseURL: "https://mon-projet062-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "mon-projet062",
            storageBucket: "mon-projet062.appspot.com",
            messagingSenderId: "1054174163421",
            appId: "1:1054174163421:web:50817b3c930a5eb55ac634"
        };
        firebase.initializeApp(config);
        const db = firebase.database().ref('harmonie_final');

        function setMood(u, e) { db.child('moods').child(u).set(e); }
        function sendLove() { db.child('love').set(Date.now()); }
        function complete(u) { confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } }); }

        const canvas = document.getElementById('pixel-canvas');
        for(let i=0; i<64; i++) {
            const p = document.createElement('div'); p.className = 'pixel';
            p.onclick = () => { let c = p.style.background.includes('rgb') ? 'rgba(255,255,255,0.05)' : '#9b5de5'; db.child('pix').child(i).set(c); };
            canvas.appendChild(p);
        }

        db.on('value', snap => {
            const d = snap.val() || {};
            if(d.moods) { ['rayan','israh'].forEach(u => { document.querySelectorAll(`#mood-${u} .mood-emoji`).forEach(e => e.classList.toggle('active', e.innerText === d.moods[u])); }); }
            if(d.pix) { document.querySelectorAll('.pixel').forEach((p, i) => p.style.background = d.pix[i] || 'rgba(255,255,255,0.05)'); }
            if(d.love) confetti({ particleCount: 40, colors: ['#9b5de5', '#f178ff'], origin: { x: 0.9, y: 0.9 } });
        });

        setInterval(() => {
            const diff = new Date().setHours(24,0,0,0) - new Date();
            const h = Math.floor(diff/3600000); const m = Math.floor((diff%3600000)/60000);
            document.getElementById('timer').innerText = `Fermeture du portail dans ${h}h ${m}m`;
        }, 1000);
    </script>
</body>
</html> 
